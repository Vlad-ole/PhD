\part{Измерение характеристик SiPM}
\section{Напряжение пробоя}
В качестве исследуемых детекторов были выбраны KETEK PM3325NP-SB0 Pin и Hamamatsu S10362-33-025C.
Наиболее важной характеристикой SiPM является напряжение пробоя.
Напряжение пробоя $V_{BD}$ - это напряжение, при котором коэффициент усиления равен нулю.

В различных работах было показано, что коэффициент усиления различных SiPM имеет линейную зависимость как от температуры,
так и от напряжения \cite{Silicon Photomultiplier's Gain Stabilization, Temperature and Bias Voltage Dependence, Characterization of SiPM: temperature dependencies, Characterisation of a silicon photomultiplier device}.
Таким образом, можно записать следующие выражения для коэффициента усиления $G(V, T)$:

\begin{eqnarray}\label{eq:G(V, T)}
G(V, T) = \frac{dG}{dV} \cdot \left( V - V_{BD}(T) \right) \\ \nonumber
G(V, T) = \frac{dG}{dT} \cdot T + G(T_0, V) \\ \nonumber
G(V, T) = a \cdot V + b \cdot T + c,
\end{eqnarray}
$$\text{где } a = \frac{dG}{dV}, b = \frac{dG}{dT}$$

Из уравнения (\ref{eq:G(V, T)}) легко найти напряжение пробоя, приравняв коэффициент усиления к нулю:
\begin{eqnarray}\label{eq:V_bd(T)}
V_{BD}(T) = \frac{-c - b \cdot T}{a}
\end{eqnarray}

Для измерения напряжения пробоя и коэффициента усиления была собрана следующая установка (рис.~\ref{image:install_V_bd}).
Led Driver по световоду посылает короткую вспышку на SiPM, вырабатывая триггерный сигнал, идущий к АЦП CAEN dt5720a.
Сигнал с SiPM проходит через усилитель и поступает в АЦП CAEN dt5720a, который интегрирует сигнал при наличии триггерного сигнала.
Полученный зарядовый спектр в режиме on-line поступает на компьютер.
Температурная стабилизация обеспечивалась при помощи ПИД-регулятора ТРМ 101.
Он имеет следующую схему работы:???.
SiPM был установлен внутри металлической коробки. С одной из сторон размещен вентилятор, который необходим для отвода тепла с Пельтье элемента.
Часть вентилятора, расположенная внутри коробки, приклеена к медной пластине. С обратной стороны медной пластины расположен SiPM.

\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{install_V_bd}}
\caption{Схема измерения напряжения пробоя SiPM. Свет из LED Driver регистрируется SiPM, усиливается и оцифровывается DT5720a.
Температурная стабилизация обеспечивается ПИД-регулятором. Отклонение температуры от установленной не превышает 1К.}
\label{image:install_V_bd}
\end{figure}

Вычисление напряжения пробоя шло в несколько этапов.
Во-первых, сигнал интегрировался в воротах длиной 1 мкс (для KETEK PM3325NP-SB0 Pin) или 200 нс (для KETEK PM3325NP-SB0 Pin).
Интенсивность Led driver менялась во время измерений, чтобы зарегистрировать максимально возможное число пиков.
В среднем записывались спектры с 10 - 12 пиками.
Поскольку при увеличении номера пика растет не только его среднее значение, но и дисперсия, то регистрация пиков с большими номерами не проводилась из-за большого времени накопления статистики.
В результате получился зарядовый спектр (рис.~\ref{image:sipm_spectrum}).
Затем окрестность каждого пика аппроксимировалась функцией гаусса и находилось среднее значение положения пика $Peak_{i}$ и ошибка определения среднего $\sigma_{Peak_{i}}$.
Причем пик с номером $0$ соответствует пику, располагающемуся вблизи нуля и возникает из-за интегрирования шумов.
Последующие пики вызваны регистрацией фотонов, излучаемых светодиодом, темновыми токами и кросстоком.
Однако среднее значение пика не зависит от причины срабатывания ячейки SiPM (если нет послеимпульсов).
В этой работе мы предпочли делать аппроксимацию в окрестности пика, в отличие других работ ???, где среднее положение пика определялось путем аппроксимации всего зарядового спектра суммой гауссов.
Это связано с тем, что наличие послеимпульсов искажает форму пиков (она становится несимметричной) и, следовательно, вносит дополнительную ошибку в определение среднего значения пика.
Величина $\Delta_{0} = Peak_{1} - Peak_{0}$ связана с коэффициентом усиления следующим образом: $G = \Delta_{0} \cdot ADC_{\text{conversion rate}} / \text{charge of electron}$,
где $ADC_{\text{conversion rate}} [мВ  / Кл] $ - коэффициент конверсии.
Чтобы увеличить точность определения коэффициента усиления, расстояния между соседними пиками $\Delta_{i}$,
имеющие точность определения $\sigma_{\Delta_j} = \sqrt{\sigma_{Peak_{i}}^2 + \sigma_{Peak_{i+1}} ^2}$, усреднялись:
$$\bar{\Delta} = \sum \limits_{i=1}^{N}    \frac{\Delta_{i} / (\sigma_{\Delta_i})^2 }        {   \sum \limits_{j=1}^{N} (\sigma_{\Delta_j})^2   } $$

Для наглядности зависимости $G(V, T = const)$ и $G(V = const, T)$ с линейной аппроксимацией приведены на рис.~ и рис.~ соответственно.
Чтобы найти параметры $a$, $b$ и $c$, все измерения $G(V, T)$ аппроксимируются зависимостью (\ref{eq:G(V, T)}).
В итоге, восстановлены следующие параметры:
$$ a = [1/В]$$
$$ b =  [1/К]$$
$$ c =  $$


\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{sipm_spectrum}}
\caption{Спектр SiPM KETEK PM3325NP-SB0 Pin при напряжении 23.4 В и температуре 265 К при облучении светодиодом.
 Штриховыми линиями показано положение пиков. Время интегрирования 1 мкс. Напряжение на светодиоде менялось во время измерения, чтобы увеличить количество наблюдаемых пиков.}
\label{image:sipm_spectrum}
\end{figure}

Зависимость напряжения пробоя от температуры для KETEK PM3325NP-SB0 Pin изображена  на рис.~\ref{image:V_bd_KETEK}.
При температуре выше 275К вклад послеимпульсов становится значительным, поэтому при данном методе измерения напряжения пробоя ошибка увеличивается.
Напряжение пробоя от температуры будет описываться следующей формулой:
$$V_{BD} = 7 [мВ/К] \cdot T[К] + 20 [В]$$
Как можно заметить, для данного типа SiPM практически отсутствует зависимость напряжения пробоя от температуры.


Зависимость напряжения пробоя от температуры для Hamamatsu S10362-33-025C изображена на рис.~\ref{image:V_bd_Hamamatsu}.
В интервале температур от 265К до 295К вклад послеимпульсов в интегрируемый заряд мал, поэтому ошибка измерения практически не меняется с температурой.
Напряжение пробоя от температуры будет описываться следующей формулой:
$$V_{BD} = 44 [мВ/К] \cdot T[К] + 56 [В]$$



\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{V_bd_KETEK}}
\caption{Напряжение пробоя SiPM KETEK PM3325NP-SB0 Pin в зависимости от температуры. Время интегрирования 1 мкс.}
\label{image:V_bd_KETEK}
\end{figure}


\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{V_bd_Hamamatsu}}
\caption{Напряжение пробоя Hamamatsu S10362-33-025C в зависимости от температуры. Время интегрирования 200 нс.}
\label{image:V_bd_Hamamatsu}
\end{figure}

\section{Нахождение формы сигнала}
\subsection{Фильтрация сигнала}
Чтобы правильно найти величину послеимпульсов, кросстоков и темновых токов, необходимо знать форму одноэлектронного сигнала.
Для анализа одноэлектронного сигнала были записаны данные с осцилографа (рис.~\ref{image:install_tektronix}).
Частота оцифровки осциллографа 5 ГГц.
В отличие от схемы с измерением напряжения пробоя, в этих измерениях светодиод не применяется.

\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{install_tektronix}}
\caption{Схема измерения формы одноэлектронного сигнала. Частота оцифровки осциллографа 5 ГГц.
Температурная стабилизация обеспечивается ПИД-регулятором. Отклонение температуры от установленной не превышает 1К.}
\label{image:install_tektronix}
\end{figure}

Поскольку каждый отдельный сигнал зашумлен, то для нахождения гладкой кривой применялось усреднение по большому числу событий (порядка 1000).
Сначала на компьютер записывался сигнал длиной 1 мс. Запуск производился единожды, после чего шла запись сигнала. Порог был на уровне шумов.
Далее вычислялась производная и выбирался порог, чтобы запуск шел именно от сигнала, а не от шумов.
Производная в точке i вычислялась как разница между точками i - 20  и  i:
$$
\frac{dV}{dt} = C \cdot (V(t_{i}) - V(t_{i - 20})),
\text{где } C \text{ - некоторая несущественная константа}
$$

Значение в 20 точек (т.е. $20 \cdot 0.2 нс = 4 нс$) выбрано из соображения, что передний фронт сигнала имеет время нарастания около 8 нс,
поэтому разница между точками будет иметь характерный пик на переднем фронте.
Если вычислять производную как разницу между соседними точками, то передний фронт будет практически неотличим от шумов.

Для различных значений перенапряжений и температур порог по производной был выбран одинаковым и составил -0.006 В (константа $C$ опущена).
На рис.~\ref{image:hamamatsu_signal_295K_4_5OV} изображен сигнал с Hamamatsu S10362-33-025C при температуре 295К и перенапряжении 4.5В.

\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{hamamatsu_signal_295K_4_5OV}}
\caption{Сигнал с Hamamatsu S10362-33-025C при температуре 295К и перенапряжении 4.5В.
Точками обозначена производная сигнала. Штриховой линией обозначен порог по производной.}
\label{image:hamamatsu_signal_295K_4_5OV}
\end{figure}

После запуска по производной в интервале от -500 нс до 500 нс считалось количество сигналов, превышавших порог.
Чтобы не считать один сигнал несколько раз, вводилось мертвое время 8 нс.
Если число сигналов в этом интервале было больше одного, то данный участок отбрасывался и брался следующий.
Это необходимо, чтобы сигнал был одиночным, т.е. был без примеси послеимпульсов.
Если же встречался один сигнал, то далее на всем интервале вычислялась максимальная (по модулю) амплитуда сигнала.
Спектр амплитуд (взят по модулю для удобства) для Hamamatsu S10362-33-025C при температуре 295К и перенапряжении 4.5В представлен на рис.~\ref{image:hamamatsu_signal_295K_4_5OV_amp}.


\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{hamamatsu_signal_295K_4_5OV_amp}}
\caption{Спектр амплитуд (по модулю) для Hamamatsu S10362-33-025C при температуре 295К и перенапряжении 4.5В.
Штриховыми линиями показаны пороги для одноэлектронного импульса.}
\label{image:hamamatsu_signal_295K_4_5OV_amp}
\end{figure}

Для анализа отбирались лишь одноэлектронные импульсы.
На заключительном этапе производилось усреднение сигналов.
Усредненные сигналы для различных температур для Hamamatsu S10362-33-025C при перенапряжении 4.5В приведены на рис.~\ref{image:revo_time_vs_temp_ham_4_5_OV}.
Можно заметить небольшое увеличение времени восстановления ячейки при понижении температуры.

\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{revo_time_vs_temp_ham_4_5_OV}}
\caption{Форма сигнала для Hamamatsu S10362-33-025C при перенапряжении 4.5В и различных температурах.
Сигнал отфильтрован от послеимпульсов, усреднен и нормирован на единичную амплитуду.}
\label{image:revo_time_vs_temp_ham_4_5_OV}
\end{figure}

\subsection{Аппроксимация одноэлектронного сигнала}
Была проведена аппроксимация полученного сигнала следующей функцией:

\begin{eqnarray}\label{eq:V(t)}
V(t) = - A \cdot \exp \left[- \frac{t - t_0}{\tau_{rec}} \right] \cdot \left( 1 - \exp \left[ -\frac{t - t_0}{\tau_{rise}} \right] \right) \cdot \theta(t - t_0) + V_0,
\end{eqnarray}

где $A$ - амплитуда импульса, $t_0$ - задержка по времени, $\tau_{rec}$ - искомое время восстановления ячейки,
$\tau_{rise}$ - время нарастания переднего фронта, $V_0$ - напряжение в отсутствии сигнала, $\theta(t - t_0)$ - функция Хевисайда.
Параметр $V_0$ вычислялся как среднее значение на участке длиной 300 нс, предшествующем появлению переднего фронта, и фиксировался при аппроксимации.
Другие параметры имели ограничения по максимальному и минимальному значению, но в довольно широких пределах.

Однако форма сигнала (рис.\ref{image:revo_time_vs_temp_ham_4_5_OV}) имеет большое отклонение от зависимости (\ref{eq:V(t)}): $\chi^2 / Dof \approx 10$.
Это объясняется конечным временным разрешением системы, в результате чего на выходе системы сигнал будет представлять свертку исходного сигнала с откликом системы.
Если предположить, что отклики генератора, усилителя и осциллографа являются гауссовыми, то итоговое временное разрешение системы
можно представить как $\sigma = \sqrt{\sigma_{amp}^2 + \sigma_{oscil}^2}$.
В этом случае получим следующую форму сигнала:

\begin{eqnarray}\label{eq:V(t)_conv}
V(t) = V_0 - \frac{A}{2} \cdot \Bigg( \left\{ F(\sigma, \tau_{rec}^{fast}) + F(\sigma, \tau_{total}^{fast}) \right\} \Bigg)
\end{eqnarray}

$$
F(\sigma, \tau) = \exp\left[ \frac{\sigma^2 - 2 t \cdot \tau}{2 \tau^2 } \right] \cdot \left( 1 + Erf \left[ \frac{t - \sigma^2 / \tau}{ \sigma \sqrt{2} } \right] \right)
$$

$$
\tau_{total}^{fast} = \frac{\tau_{rec}^{fast} \cdot \tau_{rise}}{\tau_{rec}^{fast} + \tau_{rise}}
$$


Параметр $\sigma$ определялся следующим образом.
Тестовый сигнал (меандр) подавался с генератора на усилитель и измерялся осциллографом.
Далее сигнал аппроксимировался сверткой функции Хевисайда и гаусса:

\begin{eqnarray}\label{eq:V(t)_tektronix_generator}
V(t) = A \cdot \left(1 + erf\left[\frac{t}{\sqrt{\sigma_{gen}^2 + \sigma_{oscil}^2} \sqrt{2}}\right] \right) + V_{0}
\end{eqnarray}

Результат аппроксимации приведен на рис.~\ref{image:tektronix_generator}.

\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{tektronix_generator}}
\caption{Меандр с генератора, оцифрофанный осциллографом.
На рисунке изображен усредненный 512 раз передний фронт меандра, аппроксимированный функцией  (\ref{eq:V(t)_tektronix_generator}). $\sigma \approx 0.6 $ нс.}
\label{image:tektronix_generator}
\end{figure}

Для аппроксимации использовались лишь точки, находящиеся непосредственно на фронте сигнала.
Участок, следующий после фронта, искажен отражениями в длинной линии из-за неидеальной согласованности цепи.
Суммарная длина коаксиального кабеля около 1 метра, поэтому через 3 нс после начала импульса регистрируются отражения.
Улучшить согласование цепи сложно, т.к. все входные сопротивления уже нагружены на 50 Ом.
При измерениях было протестировано несколько нагрузочных сопротивлений и выбрано то, которое в лучшей степени уменьшает отражения.

Временное разрешение осциллографа предполагается значительно лучшим,
чем разрешение генератора, поэтому $\sqrt{\sigma_{gen}^2 + \sigma_{oscil}^2} \approx \sigma_{gen} \approx 0.6$ нс.

Далее сигнал с генератора подавался на тестовый вход усилителя, который соединен с конденсатором емкостью 1 пФ.
Эта цепь является дифференцирующей, поэтому на выходе усилителя сигнал будет не только свернут с откликом усилителя, но еще и продифференцирован (рис.~\ref{image:generator_amp_tektronix}).

\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{generator_amp_tektronix}}
\caption{Сигнал с генератора, прошедший через тестовый вход усилителя и оцифрофанный осциллографом.
На рисунке изображен усредненный 512 раз сигнал. Пик аппроксимирован гауссовым распределением ($\sigma = 3$ нс).}
\label{image:generator_amp_tektronix}
\end{figure}

Основной пик аппроксимирован функцией гаусса и получено значение $\sigma = 3$ нс.
В данном случае отклик усилителя немного отличается от гауссового распределения.
Это связано с конечным быстродействием усилителя.
А сигнал, идущий после 17 нс, вызван неидеальной согласованностью цепи и отличием формы сигнала с генератора от прямоугольного.


\subsubsection{Быстрая и медленная компонента времени восстановления}

Более реалистичная модель формы сигнала должна учитывать также и медленную компоненту в сигнале \cite{Determination of the recovery time of silicon photomultipliers}.

\begin{eqnarray}\label{eq:V(t)_conv_slow}
V(t) = V_0 - \frac{A}{2} \cdot \Bigg( \left\{ F(\sigma, \tau_{rec}^{fast}) + F(\sigma, \tau_{total}^{fast}) \right\} + \\ \nonumber
\frac{R_{slow}}{R_{fast}} \cdot \left\{ F(\sigma, \tau_{rec}^{slow}) + F(\sigma, \tau_{total}^{slow}) \right\}  \Bigg)
\end{eqnarray}

В формуле (\ref{eq:V(t)_conv_slow}) параметр $R_{slow} / R_{fast}$ характеризует отношение доли медленной компоненты к быстрой компоненте времени восстановления.
Аппроксимация формы сигнала зависимостью (\ref{eq:V(t)_conv}) с быстрой и медленной компонентой имеет лучшее согласие, чем аппроксимация зависимостью только с быстрой компонентой.
Однако в модели с двумя компонентами присутствует больше параметров ($R_{slow}$, $\tau_{rec}^{slow}$) и, не смотря на меньшие значения $\chi^2$,
параметры получатся нефизическими и имеют широкий произвол в выборе, поэтому модель с наличием только быстрой компоненты оказалась предпочтительнее.

Но даже в этом случае нельзя сказать, что параметры определены верно, т.к. остается произвол в выборе параметров $\tau_{rec}$, $\tau_{rise}$  и $A$.
Детальное исследование времени восстановления в этой работе не приводится.
Однако аппроксимация моделью  позволяет (\ref{eq:V(t)_conv}) аналитически описывать сигнал и этого вполне достаточно для последующих измерений темновых токов, послеимпульсов и кросстоков.

Более детальное исследование времени восстановления приведено в работе \cite{Determination of the recovery time of silicon photomultipliers}.
Температурные зависимости времени восстановления ячейки приведены в \cite{Temperature and Bias Voltage Dependence}.

\section{Анализ сигнала}

Зная форму одноэлектронного сигнала, можно извлечь множество полезной информации о послеимпульсах, кросстоках и темновых токах.
Для этого производится разбор записанного файла, полученного ранее при нахождении формы сигнала, только с другими условиями.
Сигнал с SiMP можно представить как сумму одноэлектронных импульсов $Signal_{1e}(t - t_{i})$ со случайной амплитудой $A_{i}$ и временем возникновения $t_{i}$:

\begin{eqnarray}\label{eq:parsing}
V(t) = \sum \limits_{i = 0}^{N} A_{i} \cdot Signal_{1e}(t - t_{i}) + V_{0}
\end{eqnarray}

Форма одноэлектронного сигнала описывается выражением (\ref{eq:V(t)_conv}) и является известной функцией.
Задача заключается в нахождении параметров $A_{i}$, $t_{i}$, а также параметра $N$, который характеризует число перекрывающихся сигналов.
Если сигналы не перекрываются, то файл можно разделить на множество независимых частей,
каждая из которых будет описывать сигнал по формуле (\ref{eq:parsing}) при $N = 1$.

Также сигнал содержит случайный шум, который желательно подавить.
Однако спектр шума в значительно степени перекрывается со спектром исследуемого сигнала и шум возможно подавить лишь частично.
Для подавления шума был использован фильтр Савицкого-Голея третьего порядка и числом точек равным 51.
При малом количестве точек в окне фильтр малоэффективен, т.е. соотношение сигнал / шум практически не улучшается.
При большом количестве точек можно добиться существенного увеличения отношения сигнал / шум, однако это приведет к искажениям сигнала,
и, что более существенно, не позволит разделять близко расположенные импульсы.
Исходя из этих двух ограничений, количество точек было равным 51, что соответствует времени 10.2 нс.

Чтобы разделить записанный файл на множество независимых сигналов, используется следующий алгоритм: \\
1) Файл с данными читается в два массива: x и y. \\
2) Вычисляется первая и вторая производная при помощи фильтра Савицкого-Голея. \\
3) Запускается цикл, который пробегает последовательно все значения по индексу массива \\
4) Если производная оказывается ниже порогового значения, то время, предшествующее этому событию на 20 нс, берется как время старта сигнала.
Это условие необходимо для правильного вычисления базовой линии сигнала. \\
5) Если после того, как производная оказывается ниже порога и проходит более 5 нс и уровень сигнала выше порога по амплитуде,
а также впереди на 50 нс производная не лежит ниже порога, то данное время считается временем окончания сигнала.
Порог по амплитуде выбирается как пересечение сигнала с зашумленной базовой линией.
Условие на отсутствие в течение 50 нс нового сигнала позволяет правильно восстановить для последующего сигнала базовую линию.
Пороги по амплитуде, первой и второй производной выбирается фиксированными при данной температуре и перенапряжении.

В результате работы данного алгоритма файл с данными разбивается на множество независимых участков.
На каждом участке может находиться как один импульс, так и большее количество.

Чтобы найти параметры $A_{i}$ и $t_{i}$, данный участок необходимо аппроксимировать функцией (\ref{eq:parsing}).
Поскольку данная функция внутренне нелинейна по параметру $t_{i}$, то необходимо задать начальные параметры времени начала сигнала.
Для этого используется следующий алгоритм:\\
1) Запускается цикл, начало и конец которого определяются временами старта и окончания участка сигнала, которые были получены ранее. \\
2) Если первая производная лежит ниже порога, то на участке, начиная с этого момента и заканчивая временем, большим на 5 нс,
ищется минимум производной. Время, при котором первая производная достигла минимума, далее будет использовано в качестве стартового значения параметра $t_{i}$. \\
3) Если первая производная превысила пороговое значение и прошло более 5 нс, то разрешается поиск следующего превышения порога.\\






\section{Темновые токи}

Для измерения темновых токов использовалась установка, аналогичная предыдущей (рис.~\ref{image:install_V_bd}), только без светодиода.
Запуск производился по внутреннему триггеру. Построив зависимость частоты срабатываний от величины порога, можно найти частоту темнового тока.
В данном случае будут учтены еще и послеимпульсы, но их можно вычесть в дальнейшем.
Сначала данные длиной 120 мкс записываются на компьютер. Потом вычисляется среднее значение базовой линии на участке, где не наблюдается сигнал.
Затем в программе вычисляется количество импульсов, больших по амплитуде, чем установленный порог. Начальное значение порога равно нулю и отсчитывается от базовой линии.
Конечное значение выбирается немногим больше максимально наблюдаемой амплитуды сигнала.
Итого, полученное количество импульсов делится на длину записанного участка в секундах (120 $мкс \cdot $число отрезков).
В результате получается так называемая "лестница" - график, показывающий частоту сигнала в зависимости от порога (рис.~\ref{image:dark_current_rate_ham_33_25C_295K_73.00V}).

\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{dark_current_rate_ham_33_25C_295K_73V}}
\caption{График-лестница для Hamamatsu S10362-33-025C. Напряжение 73В, температура 295К.
Плато соответствует порогу в половину одноэлектронного импульса.}
\label{image:dark_current_rate_ham_33_25C_295K_73.00V}
\end{figure}


Штриховой линией обозначен уровень плато, где частота практически не зависит от порога.
Частота, соответствующая плато, является частотой темновых токов.
Сигналы, имеющие амплитуду меньше, чем уровень плато, являются шумами или послеимпульсами.
Сигналы, имеющие амплитуду больше, чем уровень плато, возникают уже из-за кросстоков.
Плато аппроксимируется константой и строится зависимость частоты от температуры.
Частота темновых токов пропорциональна плотности свободных носителей, которая выражается следующей формулой \cite{Characterization of SiPM: temperature dependencies}:

\begin{eqnarray}\label{eq:Hz_vs_temperature}
n(T) = A \cdot T^{3/2} \cdot \exp\left[ - \frac{E_g}{2 k_B \cdot T} \right],
\end{eqnarray}
где A - константа, зависящая от материала и технологических параметров, T - абсолютная температура, $E_g$ - ширина запрещенной зоны, $k_B$ - константа Больцмана.

Зависимость частоты от температуры была аппроксимирована функцией (\ref{eq:Hz_vs_temperature}). $\chi^2 / DoF < 1$, поэтому выбранная зависимость хорошо описывает данные.

\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{dark_current_rate_ham_33_25C_Hz_vs_temperature}}
\caption{Частота темновых токов в зависимости от температуры для Hamamatsu S10362-33-025C.
Данные аппроксимированы зависимостью (\ref{eq:Hz_vs_temperature}), причем $\chi^2 / DoF < 1$.}
\label{image:dark_current_rate_ham_33_25C_295K_73.00V}
\end{figure}




Также темновой ток зависит от перенапряжения при фиксированной температуре.
При низком перенапряжении ширина плато становится настолько малой, что определить частоту темновых токов становится невозможным.
Все зависимости были аппроксимированы экспоненциальной функцией, причем $\chi^2 / DoF \approx 1$, поэтому данная зависимость удовлетворительно описывает данные.

\begin{eqnarray}\label{eq:Hz_vs_overvoltage}
\nu(\Delta V, T = const) = B \cdot \exp[k_{\Delta V} \cdot \Delta V]
\end{eqnarray}

В других работах наблюдали как линейный рост частоты темновых токов от перенапряжения при фиксированной температуре
 \cite{Characterization and Simulation of the Response} и  \cite{After-pulsingandcross-talkinmulti-pixelphotoncounters}  , так и экспоненциальный \cite{Temperature and Bias Voltage Dependence}.

Зависимость частоты одновременно и от перенапряжения и от температуры можно записать следующим образом:

\begin{eqnarray}\label{eq:Hz_vs_overvoltage_temperature}
\nu(\Delta V, T) = C \cdot T^{3/2} \cdot \exp\left[ - \frac{E_g}{2 k_B \cdot T} + k_{\Delta V} \cdot \Delta V \right]
\end{eqnarray}

Константа $C$ не зависит ни от перенапряжения, ни от температуры.
Для того, чтобы найти значения $C, E_g, k_{\Delta V}$, все измерения частоты от температуры и перенапряжения были аппроксимированы функцией (\ref{eq:Hz_vs_overvoltage_temperature}).
В результате были восстановлены следующие значения:

$$ C = (1.76 \pm 0.41) \cdot 10^8 [Гц] $$
$$ E_g = 0.75 \pm 0.01 [эВ] $$
$$ k_{\Delta V} =  0.426 \pm 0.012 [1/В] $$

Точность аппроксимации двумерной функцией (\ref{eq:Hz_vs_overvoltage_temperature}) оказалась ниже ($\chi^2 / DoF = 160 / 67$),
 чем точность аппроксимации каждой из зависимостей (\ref{eq:Hz_vs_temperature}) или (\ref{eq:Hz_vs_overvoltage}), т.к. в этом случае параметры функции должны оставаться неизменными для всех измерений.


\begin{figure}[h]
\center{\includegraphics[width=1\linewidth]{dark_current_rate_ham_33_25C_Hz_vs_overvoltage}}
\caption{Зависимость частоты темновых токов от перенапряжения при фиксированной температуре для Hamamatsu S10362-33-025C.
Данные аппроксимированы экспоненциальной зависимостью (\ref{eq:Hz_vs_overvoltage}), причем $\chi^2 / DoF \approx 1$.}
\label{image:dark_current_rate_ham_33_25C_Hz_vs_overvoltage}
\end{figure}


\section{Кросстоки}

Существует несколько схожих вариантов измерения кросстока.
Первый заключается в использовании графика-лестницы.
При построении зависимости частоты появления сигналов от порога на графике можно наблюдать несколько участков,
на которых частота практически не зависит порога. Первое плато соответствует частоте темновых токов, которая обозначается $\nu_{0.5 p.e.}$.
Следующие наблюдаемые плато будут обусловлены наличием кросстоков. Частота второго плато обозначается $\nu_{1.5 p.e.}$, третьего - $\nu_{2.5 p.e.}$ и т.д.
Вероятность кросстока можно найти как отношение двух частот: $P_{X-talk} =  \nu_{1.5 p.e.} / \nu_{0.5 p.e.}$
Однако в нашем случае разрешение по амплитуде оказывается недостаточным, чтобы различить другие плато, кроме первого, поэтому данный метод не сработает.

Второй подход заключается в интегрировании сигнала за определенное время.
Если построить спектр накопленного заряда, то можно будет увидеть множество пиков.
Первый пик с центром в нуле - пьедестал, обусловленный интегрированием шумов.
Второй пик обусловлен одноэлектронным импульсом. Последующие пики возникают из-за наличия кросстоков.
Число событий в пиках обозначим $N_{i p.e}$, где i - номер пика, равный 1 для одноэлектронного.
Если найти отношение числа событий в пиках, вызванных кросстоком, к полному числу зарегистрированных полезных (не шумовых) событий,
то мы получим вероятность кросстока:

$$
P_{X-talk} = N_{i > 1 p.e} / ( N_{i > 1 p.e} + N_{1 p.e})
$$

Преимущество этого подхода заключается в хорошем разрешении по заряду, позволявшему четко разделять пики.
Недостаток же заключается во вкладе послеимпульсов в заряд, что приводит к искажению зарядового спектра и неоднозначному нахождению числа событий в одноэлектронном пике.

Третий, и наиболее правильный вариант измерений заключается в отбрасывании тех событий, которые содержат послеимпульсы.
Построив зависимость заряда сигнала от расстояния между ближайшими сигналами, можно наблюдать следующую картину...


\section{Послеимпульсы}

Схема измерения аналогична схеме измерения темновых токов и кросстока. Отличие состоит в обработке сигнала.
Если раньше сигнал обрабатывался в режиме on-line, то теперь данные сначала записываются на компьютер, а затем обрабатываются.
При записи использовался внутренний триггер. Уровень триггера выбирался примерно на уровне 50\% от величины одноэлектронного импульса.
Непрерывная длинна записи составила 120 мкс.



\section{Квантовая эффективность}

